(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{1288:(e,s,t)=>{Promise.resolve().then(t.bind(t,3686))},6046:(e,s,t)=>{"use strict";var r=t(6658);t.o(r,"useRouter")&&t.d(s,{useRouter:function(){return r.useRouter}})},3686:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>o});var r=t(5155),n=t(2115),a=t(6046),i=t(2649),c=t(4469),l=t(8860);function o(){let[e,s]=(0,n.useState)(null),[t,o]=(0,n.useState)([]),{isLoading:d,setLoading:h}=(0,c.M3)(!0),{error:u,setError:m,clearError:x}=(0,c.qz)(),j=(0,a.useRouter)();(0,n.useEffect)(()=>{p()},[]);let p=async()=>{try{let e=localStorage.getItem(i.vQ.session.storageKey);if(!e){j.push("/");return}let t=JSON.parse(e);s(t),await v()}catch(e){m("Error al cargar el dashboard"),console.error("Error:",e)}},v=async()=>{try{h(!0),x();let e=await (0,i.Dw)();o(e)}catch(e){m((0,i.u1)(e))}finally{h(!1)}};if(d)return(0,r.jsx)("div",{className:"loading-container",children:(0,r.jsx)("div",{className:"spinner",children:"Cargando..."})});if(u&&!e)return(0,r.jsxs)("div",{className:"error-container",children:[(0,r.jsx)("p",{className:"error-message",children:u}),(0,r.jsx)("button",{onClick:()=>j.push("/"),className:"btn btn-primary",children:"Volver al login"})]});let b={total:t.length,active:t.filter(e=>"Activo"===e.estado).length,maintenance:t.filter(e=>"Mantenimiento"===e.estado).length,inactive:t.filter(e=>"Inactivo"===e.estado).length};return(0,r.jsxs)("div",{className:"dashboard",children:[(0,r.jsxs)("nav",{className:"navbar",children:[(0,r.jsx)("div",{className:"nav-brand",children:(0,r.jsx)("h1",{children:"Inventario Municipio"})}),(0,r.jsx)("div",{className:"nav-user",children:e&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("span",{className:"welcome-text",children:["Bienvenido, ",(0,r.jsx)("strong",{children:e.username})]}),(0,r.jsxs)("span",{className:"user-role",children:["(",e.rol,")"]}),(0,r.jsx)("button",{onClick:()=>{(0,i.ri)(),j.push("/")},className:"btn btn-secondary logout-btn",type:"button",children:"Cerrar Sesi\xf3n"})]})})]}),(0,r.jsxs)("main",{className:"dashboard-content",children:[(0,r.jsxs)("div",{className:"dashboard-header",children:[(0,r.jsx)("h2",{children:"Panel de Control"}),(0,r.jsxs)("div",{className:"stats-grid",children:[(0,r.jsxs)("div",{className:"stat-card",children:[(0,r.jsx)("h3",{children:"Total"}),(0,r.jsx)("span",{className:"stat-number",children:b.total})]}),(0,r.jsxs)("div",{className:"stat-card",children:[(0,r.jsx)("h3",{children:"Activos"}),(0,r.jsx)("span",{className:"stat-number stat-success",children:b.active})]}),(0,r.jsxs)("div",{className:"stat-card",children:[(0,r.jsx)("h3",{children:"Mantenimiento"}),(0,r.jsx)("span",{className:"stat-number stat-warning",children:b.maintenance})]}),(0,r.jsxs)("div",{className:"stat-card",children:[(0,r.jsx)("h3",{children:"Inactivos"}),(0,r.jsx)("span",{className:"stat-number stat-danger",children:b.inactive})]})]})]}),u&&(0,r.jsxs)("div",{className:"alert alert-error",children:[u,(0,r.jsx)("button",{onClick:x,className:"alert-close","aria-label":"Cerrar",children:"\xd7"})]}),(0,r.jsxs)("section",{className:"equipos-section",children:[(0,r.jsxs)("div",{className:"section-header",children:[(0,r.jsx)("h3",{children:"Equipos Recientes"}),(0,r.jsx)("button",{className:"btn btn-primary",children:"+ Agregar Equipo"})]}),t.length>0?(0,r.jsx)("div",{className:"table-container",children:(0,r.jsxs)("table",{className:"equipos-table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"ID"}),(0,r.jsx)("th",{children:"Serie"}),(0,r.jsx)("th",{children:"Tipo"}),(0,r.jsx)("th",{children:"Marca"}),(0,r.jsx)("th",{children:"Estado"}),(0,r.jsx)("th",{children:"Dependencia"}),(0,r.jsx)("th",{children:"Fecha"}),(0,r.jsx)("th",{children:"Acciones"})]})}),(0,r.jsx)("tbody",{children:t.slice(0,10).map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.id}),(0,r.jsx)("td",{children:(0,r.jsx)("code",{className:"serial-code",children:e.numero_serie})}),(0,r.jsx)("td",{children:e.tipo_equipo}),(0,r.jsx)("td",{children:e.marca}),(0,r.jsx)("td",{children:(0,r.jsx)("span",{className:"status-badge status-".concat(e.estado.toLowerCase()),children:e.estado})}),(0,r.jsx)("td",{children:e.dependencia}),(0,r.jsx)("td",{children:e.fecha_adquisicion?(0,l.Yq)(e.fecha_adquisicion):"-"}),(0,r.jsx)("td",{children:(0,r.jsxs)("div",{className:"action-buttons",children:[(0,r.jsx)("button",{className:"btn btn-sm btn-outline",title:"Ver",children:"Ver"}),(0,r.jsx)("button",{className:"btn btn-sm btn-outline",title:"Editar",children:"Editar"})]})})]},e.id))})]})}):(0,r.jsxs)("div",{className:"empty-state",children:[(0,r.jsx)("p",{children:"No hay equipos registrados."}),(0,r.jsx)("button",{className:"btn btn-primary",children:"Agregar primer equipo"})]})]})]})]})}},4469:(e,s,t)=>{"use strict";t.d(s,{M3:()=>n,qz:()=>a});var r=t(2115);function n(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],[s,t]=(0,r.useState)(e);return{isLoading:s,startLoading:()=>t(!0),stopLoading:()=>t(!1),setLoading:t}}function a(){let[e,s]=(0,r.useState)(null);return{error:e,setError:e=>s(e),clearError:()=>s(null),hasError:!!e}}t(8860),t(2649)},2649:(e,s,t)=>{"use strict";t.d(s,{Dw:()=>d,iD:()=>l,ri:()=>o,u1:()=>u,vQ:()=>n});let r={BASE_URL:"http://localhost:5000",TIMEOUT:1e4},n={session:{storageKey:"inventario_user_session",tokenKey:"inventario_auth_token"}};class a extends Error{constructor(e,s){super(e),this.status=s,this.name="ApiError"}}class i{static getInstance(){return i.instance||(i.instance=new i),i.instance}async request(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t="".concat(r.BASE_URL).concat(e);try{let e=new AbortController,n=setTimeout(()=>e.abort(),r.TIMEOUT),i=await fetch(t,{headers:{"Content-Type":"application/json",Accept:"application/json",...s.headers},signal:e.signal,...s});if(clearTimeout(n),!i.ok)throw new a("Error ".concat(i.status,": ").concat(i.statusText),i.status);return i.json()}catch(e){if(e instanceof a)throw e;if(e instanceof DOMException&&"AbortError"===e.name)throw new a("Timeout: La petici\xf3n tard\xf3 demasiado");throw new a("Error de conexi\xf3n con el servidor")}}get(e,s){let t=s?"?"+new URLSearchParams(s).toString():"";return this.request("".concat(e).concat(t))}post(e,s){return this.request(e,{method:"POST",body:s?JSON.stringify(s):void 0})}put(e,s){return this.request(e,{method:"PUT",body:s?JSON.stringify(s):void 0})}delete(e){return this.request(e,{method:"DELETE"})}constructor(){}}let c=i.getInstance(),l=(e,s)=>c.post("/usuarios",{username:e,password:s}),o=()=>{localStorage.removeItem(n.session.storageKey),localStorage.removeItem(n.session.tokenKey)},d=e=>{let s=e?Object.entries(e).filter(e=>{let[s,t]=e;return void 0!==t}).reduce((e,s)=>{let[t,r]=s;return{...e,[t]:String(r)}},{}):void 0;return c.get("/inventario",s)},h=e=>e instanceof a,u=e=>h(e)||e instanceof Error?e.message:"Error desconocido"},8860:(e,s,t)=>{"use strict";t.d(s,{Yq:()=>r});let r=e=>{try{let s="string"==typeof e?new Date(e):e;return new Intl.DateTimeFormat("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"}).format(s)}catch(e){return"Fecha inv\xe1lida"}}}},e=>{var s=s=>e(e.s=s);e.O(0,[441,517,358],()=>s(1288)),_N_E=e.O()}]);